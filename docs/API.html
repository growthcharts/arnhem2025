<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>api – JAMES Workshop</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-6bd9cfa162949bde0a231f530c97869d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">JAMES Workshop</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./program.html"> 
<span class="menu-text">Programma</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-onderwerpen" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Onderwerpen</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-onderwerpen">    
        <li>
    <a class="dropdown-item" href="./introductie.html">
 <span class="dropdown-text">JAMES</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dscore.html">
 <span class="dropdown-text">D-score</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./zscore.html">
 <span class="dropdown-text">Z-score</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./screening.html">
 <span class="dropdown-text">Screening</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-practica" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Practica</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-practica">    
        <li>
    <a class="dropdown-item" href="./practicum_1.html">
 <span class="dropdown-text">Practicum 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./practicum_2.html">
 <span class="dropdown-text">Practicum 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./practicum_3.html">
 <span class="dropdown-text">Practicum 3</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link active" href="./API.html" aria-current="page"> 
<span class="menu-text">API</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<p><img src="img/tno-logo.svg" alt="TNO logo" style="height: 50px;"></p>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#purpose" id="toc-purpose" class="nav-link active" data-scroll-target="#purpose">Purpose</a></li>
  <li><a href="#james-api-overview" id="toc-james-api-overview" class="nav-link" data-scroll-target="#james-api-overview">JAMES API overview</a>
  <ul class="collapse">
  <li><a href="#primary-api-end-points" id="toc-primary-api-end-points" class="nav-link" data-scroll-target="#primary-api-end-points">Primary API end points</a></li>
  <li><a href="#output-formats" id="toc-output-formats" class="nav-link" data-scroll-target="#output-formats">Output formats</a></li>
  </ul></li>
  <li><a href="#end-points" id="toc-end-points" class="nav-link" data-scroll-target="#end-points">End points</a>
  <ul class="collapse">
  <li><a href="#version-obtain-version-information" id="toc-version-obtain-version-information" class="nav-link" data-scroll-target="#version-obtain-version-information"><strong><code>/version</code></strong>: Obtain version information</a></li>
  <li><a href="#dataupload-upload-child-data" id="toc-dataupload-upload-child-data" class="nav-link" data-scroll-target="#dataupload-upload-child-data"><strong><code>/data/upload</code></strong>: Upload child data</a></li>
  <li><a href="#chartsdraw-draw-child-data-on-growth-chart" id="toc-chartsdraw-draw-child-data-on-growth-chart" class="nav-link" data-scroll-target="#chartsdraw-draw-child-data-on-growth-chart"><strong><code>/charts/draw</code></strong>: Draw child data on growth chart</a></li>
  <li><a href="#chartslist-list-available-growth-charts" id="toc-chartslist-list-available-growth-charts" class="nav-link" data-scroll-target="#chartslist-list-available-growth-charts"><strong><code>/charts/list</code></strong>: List available growth charts</a></li>
  <li><a href="#chartsvalidate-validate-chart-codes" id="toc-chartsvalidate-validate-chart-codes" class="nav-link" data-scroll-target="#chartsvalidate-validate-chart-codes"><strong><code>/charts/validate</code></strong>: Validate chart codes</a></li>
  <li><a href="#screenerslist-list-available-growth-screeners" id="toc-screenerslist-list-available-growth-screeners" class="nav-link" data-scroll-target="#screenerslist-list-available-growth-screeners"><strong><code>/screeners/list</code></strong>: List available growth screeners</a></li>
  <li><a href="#screenersapply-apply-growth-screeners-to-child-data" id="toc-screenersapply-apply-growth-screeners-to-child-data" class="nav-link" data-scroll-target="#screenersapply-apply-growth-screeners-to-child-data"><strong><code>/screeners/apply</code></strong>: Apply growth screeners to child data</a></li>
  <li><a href="#site-request-an-empty-site" id="toc-site-request-an-empty-site" class="nav-link" data-scroll-target="#site-request-an-empty-site"><strong><code>/site</code></strong>: Request an empty site</a></li>
  <li><a href="#siterequest-request-personalised-site" id="toc-siterequest-request-personalised-site" class="nav-link" data-scroll-target="#siterequest-request-personalised-site"><strong><code>/site/request</code></strong>: Request personalised site</a></li>
  <li><a href="#blendrequest-obtain-a-blend-from-multiple-end-points" id="toc-blendrequest-obtain-a-blend-from-multiple-end-points" class="nav-link" data-scroll-target="#blendrequest-obtain-a-blend-from-multiple-end-points"><strong><code>/blend/request</code></strong>: Obtain a blend from multiple end points</a></li>
  </ul></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources">Resources</a>
  <ul class="collapse">
  <li><a href="#internal" id="toc-internal" class="nav-link" data-scroll-target="#internal">Internal</a></li>
  <li><a href="#external" id="toc-external" class="nav-link" data-scroll-target="#external">External</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<section id="purpose" class="level2">
<h2 class="anchored" data-anchor-id="purpose">Purpose</h2>
<p><strong>JAMES</strong> is a web service designed to support <strong>real-time, individual-level decision making</strong> in the evaluation and prediction of child growth and development. It integrates seamlessly with electronic youth health care systems in the Netherlands via the standardized <a href="https://www.ncj.nl/onderwerp/digitaal-dossier-jgz/bds-jgz-versiebeheer/">Basisdataset JGZ (BDS)</a>, and is intended for use by pediatricians, youth health nurses, and other healthcare professionals.</p>
<p>The current version of JAMES:</p>
<ol type="1">
<li>provides access to high-quality growth charts used in Dutch youth health care;</li>
<li>supports the exchange of data encoded using the Basisdataset JGZ 4.0.1 standard;</li>
<li>screens for abnormal values in height, weight, and head circumference;</li>
<li>transforms developmental milestones into the D-score metric;</li>
<li>predicts future growth and developmental trajectories.</li>
</ol>
<p>JAMES is implemented as a RESTful API hosted on remote servers. Clients can interact with the service using any HTTP-compatible environment. This documentation illustrates example requests using both R and the command line, and highlights common applications with pointers to additional resources.</p>
<p>The examples in this document use the development and demonstration server, which is intended for testing and educational purposes only. For access to the licensed production environment, please contact TNO license contact <a href="mailto:olivier.blansonhenkemans@tno.nl">olivier.blansonhenkemans [at] tno.nl</a>.</p>
<p>JAMES is developed and maintained by <a href="https://www.tno.nl/en/healthy/youth-health/i-jgz/">TNO</a> (Netherlands Organisation for Applied Scientific Research).</p>
</section>
<section id="james-api-overview" class="level2">
<h2 class="anchored" data-anchor-id="james-api-overview">JAMES API overview</h2>
<section id="primary-api-end-points" class="level3">
<h3 class="anchored" data-anchor-id="primary-api-end-points">Primary API end points</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 26%">
<col style="width: 41%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Verb</th>
<th style="text-align: left;">API end point</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Maps to <code>R</code> function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">POST</td>
<td style="text-align: left;"><code>/data/upload/{dfm}</code></td>
<td style="text-align: left;">Upload child data</td>
<td style="text-align: left;"><code>upload_data()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">POST</td>
<td style="text-align: left;"><code>/charts/draw/{ffm}</code></td>
<td style="text-align: left;">Draw child data on growth chart</td>
<td style="text-align: left;"><code>draw_chart()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">POST</td>
<td style="text-align: left;"><code>/charts/list/{dfm}</code></td>
<td style="text-align: left;">List available growth charts</td>
<td style="text-align: left;"><code>list_charts()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">POST</td>
<td style="text-align: left;"><code>/charts/validate/{dfm}</code></td>
<td style="text-align: left;">Validate a chart code</td>
<td style="text-align: left;"><code>validate_chartcode()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">POST</td>
<td style="text-align: left;"><code>/screeners/list/{dfm}</code></td>
<td style="text-align: left;">List available growth screeners</td>
<td style="text-align: left;"><code>list_screeners()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">POST</td>
<td style="text-align: left;"><code>/screeners/apply/{dfm}</code></td>
<td style="text-align: left;">Apply growth screeners to child data</td>
<td style="text-align: left;"><code>apply_screeners()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">GET</td>
<td style="text-align: left;"><code>/site</code></td>
<td style="text-align: left;">Request empty site</td>
<td style="text-align: left;"><code>request_site()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">POST</td>
<td style="text-align: left;"><code>/site/request/{dfm}</code></td>
<td style="text-align: left;">Request personalised site</td>
<td style="text-align: left;"><code>request_site()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">POST</td>
<td style="text-align: left;"><code>/blend/request/{sfm}</code></td>
<td style="text-align: left;">Obtain a blend from multiple end points</td>
<td style="text-align: left;"><code>request_blend()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">POST</td>
<td style="text-align: left;"><code>/version/{dfm}</code></td>
<td style="text-align: left;">Obtain version information</td>
<td style="text-align: left;"><code>version()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">GET</td>
<td style="text-align: left;"><code>/{session}/{info}</code></td>
<td style="text-align: left;">Extract session details</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">GET</td>
<td style="text-align: left;"><code>/{2}/{1}/man</code></td>
<td style="text-align: left;">Consult R help</td>
<td style="text-align: left;"><code>help({1}_{2})</code></td>
</tr>
</tbody>
</table>
<p>The table lists the defined API end points and the mapping to each end point to the corresponding R function in the <code>james</code> package. The API end points are grouped by the type of functionality they provide. The first column indicates the HTTP verb used to access the end point, and the second column provides a brief description of the end point’s purpose.</p>
<p>The OpenAPI definition of JAMES is at <a href="https://app.swaggerhub.com/apis/stefvanbuuren/james/1.5.4" class="uri">https://app.swaggerhub.com/apis/stefvanbuuren/james/1.5.4</a>. The API is currently frozen at version 1.5.4. The API is subject to change in future versions.</p>
</section>
<section id="output-formats" class="level3">
<h3 class="anchored" data-anchor-id="output-formats">Output formats</h3>
<p>JAMES is built on top of the <a href="https://www.opencpu.org/api.html"><strong>OpenCPU API</strong></a>, a powerful and flexible way for online deployment of R functionality. Although it is possible to use JAMES without knowledge of OpenCPU, it is useful to browse the OpenCPU features.</p>
<p>OpenCPU offers multiple output formats out of the box. JAMES supports a subset of these through the <code>/{session}/{info}</code> end point. Here <code>session</code> is a special session code generated by OpenCPU that identifies the server location containing the results of a request. The output format <code>info</code> is one of the following:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"><code>{info}</code></th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>json</code></td>
<td style="text-align: left;">Function result as JSON</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>print</code></td>
<td style="text-align: left;">Function result as formatted as print</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>csv</code></td>
<td style="text-align: left;">Function result as comma-separated format</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>tab</code></td>
<td style="text-align: left;">Function result as tab-delimited format</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>md</code></td>
<td style="text-align: left;">Function result as markdown format</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>svglite</code></td>
<td style="text-align: left;">Function result as SVG graph</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>warnings</code></td>
<td style="text-align: left;">Warnings from the R execution</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>messages</code></td>
<td style="text-align: left;">Messages, especially data validation info</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>console</code></td>
<td style="text-align: left;">Console print out, useful for locating errors</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>stdout</code></td>
<td style="text-align: left;">Standard output</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>info</code></td>
<td style="text-align: left;">Overview of JAMES deployment</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>parent</code></td>
<td style="text-align: left;">Parent directory of all OpenCPU session output</td>
</tr>
</tbody>
</table>
<p>In addition, the user can request the function result in a particular form. JAMES distinguishes the following groups of formats.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 81%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Format group</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>dfm</code></td>
<td style="text-align: left;">Data format: <code>json</code>, <code>csv</code>, <code>tab</code>, <code>md</code>, <code>print</code>, <code>parent</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ffm</code></td>
<td style="text-align: left;">Figure format: <code>svglite</code>, <code>print</code>, <code>parent</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>sfm</code></td>
<td style="text-align: left;">System format: <code>json</code>, <code>print</code>, <code>parent</code></td>
</tr>
</tbody>
</table>
<p>In general, the user can specify the desired format by appending the format name to the URL. See <a href="https://www.opencpu.org/api.html#api-formats" class="uri">https://www.opencpu.org/api.html#api-formats</a> for examples.</p>
</section>
</section>
<section id="end-points" class="level2">
<h2 class="anchored" data-anchor-id="end-points">End points</h2>
<p>This section provides a quick introduction into the main JAMES end points, and how these can be assessed from <code>R</code> and from the command line.</p>
<section id="version-obtain-version-information" class="level3">
<h3 class="anchored" data-anchor-id="version-obtain-version-information"><strong><code>/version</code></strong>: Obtain version information</h3>
<p>Let us first check whether JAMES is running. The following code makes a simple request to JAMES to see whether it is alive and to return the version number of the underlying <code>james</code> R package. We illustrate both requests in <code>R</code> and in <code>bash</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">bash</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>We first need to install and load packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"remotes"</span>, <span class="st">"httr"</span>, <span class="st">"jsonlite"</span>, <span class="st">"dscore"</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"growthcharts/jamesclient"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"growthcharts/jamesdemodata"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"growthcharts/bdsreader"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jamesclient)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s find out the JAMES version number. In this document, we define the server that hosts JAMES as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># host &lt;- "http://localhost"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>host <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"JAMES_HOST"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="fu">paste0</span>(<span class="st">"echo "</span>, host, <span class="st">" &gt; .host"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We first illustrate a method that makes two requests to the server. The following commands call the <code>/version/json</code> end point in the JAMES API.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host, <span class="at">path =</span> <span class="st">"version/json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We added the <code>/json</code> to the pathname to extract the JSON representation of the result of the <code>R</code> function <code>james::version()</code>. The function result is an object of class <code>james_post</code> and consists of various components.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "url"          "status_code"  "headers"      "all_headers"  "cookies"     
 [6] "content"      "date"         "times"        "request"      "handle"      
[11] "request_path" "parsed"       "warnings"     "messages"     "session"     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>r<span class="sc">$</span>url</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Most of the element are documented in the <code>response</code> object in the <code>httr</code> package. For example, we could use the call <code>httr::status_code(r)</code> to obtain the status code. The function <code>james_post()</code> adds the last five elements:</p>
<ul>
<li><code>r$request_path</code> echoes the endpoint, here <code>/version/json</code>;</li>
<li><code>r$parsed</code> is a parsed version of the element <code>r$content</code>. Here it is a list of elements like names of the package, its date, and so on. In case of an error of the server function, we find the error message here;</li>
<li><code>r$warnings</code> contain any warnings thrown during execution;</li>
<li><code>r$messages</code> contain any messages, e.g.&nbsp;data reading errors;</li>
<li><code>r$session</code> (like x05e353b79df7c2) is a unique session code.</li>
</ul>
<p>The <code>jamesclient::james_post()</code> function wraps the basis workhorse <code>httr::POST()</code> that does the actual server request. For illustration, we may obtain equivalent content by the POST function directly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">"version/json"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="fu">parse_url</span>(host)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(url, <span class="at">path =</span> <span class="fu">file.path</span>(url<span class="sc">$</span>path, path), <span class="at">query =</span> <span class="st">"auto_unbox=true"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">POST</span>(url)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fromJSON</span>(<span class="fu">content</span>(r, <span class="at">type =</span> <span class="st">"text"</span>, <span class="at">encoding =</span> <span class="st">"UTF-8"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$package
[1] "james"

$packageVersion
[1] "1.7.2"

$packageDate
[1] "2025-02-10"

$Rversion
[1] "4.4.1"</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>We use the <code>curl</code> Linux command. If needed, on Ubuntu install <code>curl</code> as</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt update</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt <span class="at">-y</span> install curl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s find out the JAMES version number. We first illustrate a method that makes two requests to the server.</p>
<p>The following <code>bash</code> commands call the <code>/version</code> API end point</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-sX</span> <span class="st">'GET'</span> <span class="dt">\</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>   <span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span>/version <span class="dt">\</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">'accept: text/json'</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-sX</span> POST <span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span>/version <span class="op">&gt;</span> resp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The response to the request consists of a set of URLs created on the server, each of which contains details on the response.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> resp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/ocpu/tmp/x0127e1aa1350a4/R/.val
/ocpu/tmp/x0127e1aa1350a4/R/version
/ocpu/tmp/x0127e1aa1350a4/stdout
/ocpu/tmp/x0127e1aa1350a4/source
/ocpu/tmp/x0127e1aa1350a4/console
/ocpu/tmp/x0127e1aa1350a4/info
/ocpu/tmp/x0127e1aa1350a4/files/DESCRIPTION</code></pre>
</div>
</div>
<p>The path element following <code>tmp/</code> is a unique session key. See <a href="https://www.opencpu.org/api.html" class="uri">https://www.opencpu.org/api.html</a> for the interpretation of the OpenCPU API.</p>
<p>The next snippet constructs the URL of a JSON representation of the result and downloads the contents of the URL as a file <code>value1</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-s</span> <span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)$(</span><span class="fu">head</span> <span class="at">-1</span> resp<span class="va">)</span>/json<span class="pp">?</span>auto_unbox=true <span class="op">&gt;</span> value1</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> value1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{
  "package": "james",
  "packageVersion": "1.7.2",
  "packageDate": "2025-02-10",
  "Rversion": "4.4.1"
}</code></pre>
</div>
</div>
<p>The above sequence makes two requests to the server. The following code compacts both steps into one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-sX</span> POST <span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span>/version/json<span class="pp">?</span>auto_unbox=true <span class="op">&gt;</span> value2</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> value2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{
  "package": "james",
  "packageVersion": "1.7.2",
  "packageDate": "2025-02-10",
  "Rversion": "4.4.1"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="dataupload-upload-child-data" class="level3">
<h3 class="anchored" data-anchor-id="dataupload-upload-child-data"><strong><code>/data/upload</code></strong>: Upload child data</h3>
<p>JAMES understands data that conform to the <a href="https://www.ncj.nl/onderwerp/digitaal-dossier-jgz/bds-jgz-versiebeheer/">Basisdataset JGZ 4.0.1</a> coded as JSON according to a <a href="https://github.com/growthcharts/bdsreader/blob/master/inst/schemas/bds_v3.0.json">JSON schema</a>. This section explains how we create, validate and upload child data to JAMES.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">bash</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Let us assume that we have child data stored in <code>JSON</code> format. Here we copy the longitudinal demo data <code>maria.json</code> from the <code>jamesdemodata</code> package into the working directory.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"json"</span>, <span class="st">"examples"</span>, <span class="st">"maria.json"</span>, <span class="at">package =</span> <span class="st">"jamesdemodata"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">file.copy</span>(fn, <span class="st">"maria.json"</span>, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>The first 10 lines of the file in <code>json</code> format, ready for upload:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="fu">readLines</span>(<span class="st">"maria.json"</span>, <span class="at">n =</span> <span class="dv">10</span>), <span class="at">collapse =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">..."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{
  "Format": "3.0",
  "organisationCode": 1234,
  "reference": "Maria",
  "clientDetails": [
    {
      "bdsNumber": 19,
      "value": "2"
    },
    { 
...</code></pre>
</div>
</div>
<p>There are four ways to upload the data to JAMES:</p>
<ol type="1">
<li>Upload the file <code>"maria.json"</code>;</li>
<li>Convert to a string and upload;</li>
<li>Convert to a JSON object and upload;</li>
<li>Read the JSON file from a URL.</li>
</ol>
<p>The <code>/data/upload</code> API end point handles these cases as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># upload as local file</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="st">"maria.json"</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host, <span class="at">path =</span> <span class="st">"data/upload/json"</span>, <span class="at">txt =</span> fn)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">status_code</span>(r1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 201</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># upload as string</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>js <span class="ot">&lt;-</span> <span class="fu">read_json_js</span>(fn)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host, <span class="at">path =</span> <span class="st">"data/upload/json"</span>, <span class="at">txt =</span> js)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">status_code</span>(r2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 201</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># upload as JSON object</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>jo <span class="ot">&lt;-</span> <span class="fu">read_json_jo</span>(fn)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>r3 <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host, <span class="at">path =</span> <span class="st">"data/upload/json"</span>, <span class="at">txt =</span> jo)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">status_code</span>(r3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 201</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># upload as URL</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/growthcharts/jamesdemodata/refs/heads/master/inst/json/examples/maria.json"</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>r4 <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host, <span class="at">path =</span> <span class="st">"data/upload/json"</span>, <span class="at">txt =</span> url)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">status_code</span>(r4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 201</code></pre>
</div>
</div>
<p>If the status is 201, the data are uploaded to JAMES and processed. For example, the processed data after file upload is available as an R data frame under element <code>r1$parsed</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>r1<span class="sc">$</span>parsed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$psn
  id  name        dob       dobm       dobf  src    sex gad ga smo  bw hgtm
1 -1 Maria 2018-10-11 1990-12-02 1995-07-04 1234 female 189 27   1 990  167
  hgtf
1  190

$xyz
      age xname yname zname                  zref       x     y      z
1  0.0849   age   hgt hgt_z nl_2012_hgt_female_27  0.0849 38.00 -0.158
2  0.1670   age   hgt hgt_z nl_2012_hgt_female_27  0.1670 43.50  0.047
3  0.0000   age   wgt wgt_z nl_2012_wgt_female_27  0.0000  0.99  0.190
4  0.0849   age   wgt wgt_z nl_2012_wgt_female_27  0.0849  1.25 -0.203
5  0.1670   age   wgt wgt_z nl_2012_wgt_female_27  0.1670  2.10  0.015
6  0.0849   age   hdc hdc_z nl_2012_hdc_female_27  0.0849 27.00 -0.709
7  0.1670   age   hdc hdc_z nl_2012_hdc_female_27  0.1670 30.50 -0.913
8  0.0000   age   bmi bmi_z nl_1997_bmi_female_nl  0.0000    NA     NA
9  0.0849   age   bmi bmi_z nl_1997_bmi_female_nl  0.0849  8.66 -5.719
10 0.1670   age   bmi bmi_z nl_1997_bmi_female_nl  0.1670 11.10 -3.767
11 0.0000   hgt   wfh wfh_z   nl_2012_wfh_female_      NA  0.99     NA
12 0.0849   hgt   wfh wfh_z   nl_2012_wfh_female_ 38.0000  1.25 -0.001
13 0.1670   hgt   wfh wfh_z   nl_2012_wfh_female_ 43.5000  2.10  0.326</code></pre>
</div>
</div>
<p>The session details, including the uploaded data, will remain available for a limited time. After 30 minutes the session is wiped. The session key is your entrance to the resource within the 30-minute window. The key can be retrieved as <code>r1$session</code>. For example, to see the result of the file upload session in markdown use</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>(session <span class="ot">&lt;-</span> r1<span class="sc">$</span>session)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "x0023f74df46100"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> <span class="fu">james_get</span>(<span class="at">host =</span> host, <span class="at">path =</span> <span class="fu">file.path</span>(session, <span class="st">"md"</span>))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(resp<span class="sc">$</span>parsed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

  * **psn**:

    -------------------------------------------------------------------------------
     id   name       dob          dobm         dobf      src    dnr    sex     gad
    ---- ------- ------------ ------------ ------------ ------ ----- -------- -----
     -1   Maria   2018-10-11   1990-12-02   1995-07-04   1234   NA    female   189
    -------------------------------------------------------------------------------

    Table: Table continues below

    -----------------------------------------------------------------------------------
     ga   smo   bw    hgtm   hgtf   agem   etn   pc4   blbf   blbm   eduf   edum   par
    ---- ----- ----- ------ ------ ------ ----- ----- ------ ------ ------ ------ -----
     27    1    990   167    190     NA    NA    NA     NA     NA     NA     NA    NA
    -----------------------------------------------------------------------------------

  * **xyz**:

    ----------------------------------------------------------------------------------
      age     xname   yname   zname           zref              x        y       z
    -------- ------- ------- ------- ----------------------- -------- ------- --------
     0.0849    age     hgt    hgt_z   nl_2012_hgt_female_27   0.0849    38     -0.158

     0.167     age     hgt    hgt_z   nl_2012_hgt_female_27   0.167    43.5    0.047

       0       age     wgt    wgt_z   nl_2012_wgt_female_27     0      0.99     0.19

     0.0849    age     wgt    wgt_z   nl_2012_wgt_female_27   0.0849   1.25    -0.203

     0.167     age     wgt    wgt_z   nl_2012_wgt_female_27   0.167     2.1    0.015

     0.0849    age     hdc    hdc_z   nl_2012_hdc_female_27   0.0849    27     -0.709

     0.167     age     hdc    hdc_z   nl_2012_hdc_female_27   0.167    30.5    -0.913

       0       age     bmi    bmi_z   nl_1997_bmi_female_nl     0       NA       NA

     0.0849    age     bmi    bmi_z   nl_1997_bmi_female_nl   0.0849   8.657   -5.719

     0.167     age     bmi    bmi_z   nl_1997_bmi_female_nl   0.167    11.1    -3.767

       0       hgt     wfh    wfh_z    nl_2012_wfh_female_      NA     0.99      NA

     0.0849    hgt     wfh    wfh_z    nl_2012_wfh_female_      38     1.25    -0.001

     0.167     hgt     wfh    wfh_z    nl_2012_wfh_female_     43.5     2.1    0.326
    ----------------------------------------------------------------------------------


&lt;!-- end of list --&gt;</code></pre>
</div>
</div>
<p><strong>Troubleshooting data upload</strong>: JAMES executes checks on the conversion and ranges of the data. To gain efficiency, it does not automatically validate the input data against the specified JSON schema. JAMES writes diagnostic, sometimes cryptic, messages to the directory <code>{session}/messages</code> if it finds a problem. The user can rerun the data upload with two additional flags that request extra diagnostic output.</p>
<p>Example: Suppose we compromise the data by removing the required <code>"clientDetails"</code> and the optional <code>"nestedDetails"</code> sections. The mangled input data look like:</p>
<pre><code>{"Format":"3.0","organisationCode":12345,"reference":"Maria's mangled data","clientMeasurements":[{"bdsNumber":235,"values":[{"date":"20181111","value":380},{"date":"20181211","value":435}]}]}</code></pre>
<p>Everything appears normal if we read this data by the default:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"json"</span>, <span class="st">"examples"</span>, <span class="st">"maria-mangled.json"</span>, <span class="at">package =</span> <span class="st">"jamesdemodata"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>r5 <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host, <span class="at">path =</span> <span class="st">"data/upload/json"</span>, <span class="at">txt =</span> fn)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>r5<span class="sc">$</span>parsed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$psn
  id                 name   src
1 -1 Maria's mangled data 12345

$xyz
  xname yname zname            zref  y
1   age   hgt hgt_z nl_1997_hgt__nl 38</code></pre>
</div>
</div>
<p>If we upload with the additional <code>validate = TRUE</code> flag, JAMES runs the validation of the uploaded JSON against the JSON schema:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>r6 <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host, <span class="at">path =</span> <span class="st">"data/upload/json"</span>, <span class="at">txt =</span> fn, <span class="at">validate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>mess <span class="ot">&lt;-</span> <span class="fu">james_get</span>(<span class="at">host =</span> host, <span class="at">path =</span> <span class="fu">file.path</span>(r6<span class="sc">$</span>session, <span class="st">"messages"</span>))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(mess<span class="sc">$</span>parsed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>which indicates that the required JSON element <code>"clientDetails"</code> is missing. We inactivated the code chunk above because it may occasionally give the error “JAMES API request failed [400] child process has died In call: tryCatch()” when <code>validate = TRUE</code>. This is a known, not yet resolved issue.</p>
<p>We may drill down further by setting the <code>intermediate = TRUE</code> flag. This writes five JSON files that document the data flow into <code>{session}/files/{*}.json</code>.</p>
<p>For example, we can ask for the input data as read by JAMES by</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>r7 <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host, <span class="at">path =</span> <span class="st">"data/upload/json"</span>, <span class="at">txt =</span> fn, <span class="at">validate =</span> <span class="cn">TRUE</span>, <span class="at">intermediate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="fu">file.path</span>(host, r7<span class="sc">$</span>session, <span class="st">"files/input.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With <code>browseURL(url)</code> we may view the file contents in the browser. The <code>files</code> directory contains five JSON files:</p>
<ol type="1">
<li><code>files/input.json</code>: the JSON input data;</li>
<li><code>files/bds.json</code>: a data frame with info per BDS number;</li>
<li><code>files/ddi.json</code>: result of recoding BDS into GSED item names;</li>
<li><code>files/psn.json</code>: known fixed child covariates;</li>
<li><code>files/xy.json</code>: time-varying variables.</li>
</ol>
<p>Inspection of these files may uncover any problems with JAMES’s understanding of the data. If needed, study the underlying R source code at <a href="https://raw.githubusercontent.com/growthcharts/bdsreader/master/R/read_bds.R" class="uri">https://raw.githubusercontent.com/growthcharts/bdsreader/master/R/read_bds.R</a>.</p>
<p>The <code>validate</code> and <code>intermediate</code> flag are useful for development and debugging. In production, we recommend leaving them at their default value (<code>FALSE</code>) and monitor any messages written to <code>{session}/messages</code>.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>We start from child data in the file <code>maria.json</code> that we wish to process with JAMES. For testing purposes, you may change the values, but keep the general structure intact. The following <code>curl</code> commands uploads the file and processes the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-sF</span> <span class="st">'txt=@maria.json'</span> <span class="at">-D</span> headers <span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span>/data/upload/json <span class="op">&gt;</span> content</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> content</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{
  "psn": [
    {
      "id": -1,
      "name": "Maria",
      "dob": "2018-10-11",
      "dobm": "1990-12-02",
      "dobf": "1995-07-04",
      "src": "1234",
      "sex": "female",</code></pre>
</div>
</div>
<p>Alternatively, we may read the file into a JSON string, and upload as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="va">JS</span><span class="op">=</span><span class="va">$(</span><span class="ex">jq</span> <span class="st">'.'</span> maria.json <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-sR</span> <span class="st">'.'</span><span class="va">)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-s</span> <span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span>/data/upload/json <span class="at">-d</span> <span class="st">"txt=</span><span class="va">$JS</span><span class="st">"</span> <span class="op">&gt;</span> content</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, if the data are located at a URL, use</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="va">URL</span><span class="op">=</span><span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span>/ocpu/library/jamesdemodata/json/examples/maria.json</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-s</span> <span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span>/data/upload/json <span class="at">-d</span> <span class="st">"txt='</span><span class="va">$URL</span><span class="st">'"</span> <span class="op">&gt;</span> content</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="chartsdraw-draw-child-data-on-growth-chart" class="level3">
<h3 class="anchored" data-anchor-id="chartsdraw-draw-child-data-on-growth-chart"><strong><code>/charts/draw</code></strong>: Draw child data on growth chart</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">bash</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Maria is a preterm born at 27 weeks of gestational age. We already uploaded her data. We may now plot her growth data on the A4 chart for preterms as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>r5 <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">path =</span> <span class="st">"/charts/draw/svglite"</span>, </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">session =</span> r1<span class="sc">$</span>session,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chartcode =</span> <span class="st">"PMAAN27"</span>, <span class="at">selector =</span> <span class="st">"chartcode"</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">query =</span> <span class="fu">list</span>(<span class="at">height =</span> <span class="fl">29.7</span><span class="sc">/</span><span class="fl">2.54</span>, <span class="at">width =</span> <span class="dv">21</span><span class="sc">/</span><span class="fl">2.54</span>))</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">"img"</span>)) <span class="fu">dir.create</span>(<span class="st">"img"</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(r5<span class="sc">$</span>parsed, <span class="at">con =</span> <span class="st">"img/chart1.svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/chart1.svg" class="img-fluid figure-img"></p>
<figcaption>Maria’s growth plotted on preterm chart, 0-15 months</figcaption>
</figure>
</div>
</div>
</div>
<p>Alternatively, we may upload data for a new child Laura and plot the data in one step:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"extdata/bds_v3.0/smocc/Laura_S.json"</span>, <span class="at">package =</span> <span class="st">"jamesdemodata"</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>r6 <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">path =</span> <span class="st">"/charts/draw/svglite"</span>, <span class="at">txt =</span> fn, </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chartcode =</span> <span class="st">"NMBA"</span>, <span class="at">selector =</span> <span class="st">"chartcode"</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">query =</span> <span class="fu">list</span>(<span class="at">height =</span> <span class="fl">29.7</span><span class="sc">/</span><span class="fl">2.54</span>, <span class="at">width =</span> <span class="dv">21</span><span class="sc">/</span><span class="fl">2.54</span>))</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(r6<span class="sc">$</span>parsed, <span class="at">con =</span> <span class="st">"img/chart2.svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For A4 sized charts, we recommend to generate the plot with query arguments <code>list(height = 29.7/2.54, width = 21/2.54)</code>, as illustrated above. If you want to change the chart’s size in your HTML, use the <code>out.width</code> knitr chunk option, e.g.&nbsp;set <code>out.width="500px"</code>. This gives the following output.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/chart2.svg" class="img-fluid figure-img" width="500"></p>
<figcaption>Laura’s growth plotted on chart for Dutch girls, 0-4 years</figcaption>
</figure>
</div>
</div>
</div>
<p>JAMES features a built-in prediction module based on curve matching. Suppose we want to predict Laura’s height at the 3y9m when Laura is 2 years old. The following chart plots 25 matches to Laura as grey curves. The variation between the grey curves at age 3y9m indicates the likely variation in the prediction. The blue line indicates Laura’s predicted height at age 3y9m.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>r7 <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host, </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">path =</span> <span class="st">"/charts/draw/svglite"</span>, <span class="at">txt =</span> fn, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chartcode =</span> <span class="st">"NMBH"</span>, <span class="at">dnr =</span> <span class="st">"2-4"</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lo =</span> <span class="fl">2.0</span>, <span class="at">hi =</span> <span class="fl">3.75</span>, <span class="at">nmatch =</span> <span class="dv">25</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show_future =</span> <span class="cn">TRUE</span>, <span class="at">show_realized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">query =</span> <span class="fu">list</span>(<span class="at">height =</span> <span class="dv">18</span><span class="sc">/</span><span class="fl">2.54</span>, <span class="at">width =</span> <span class="dv">18</span><span class="sc">/</span><span class="fl">2.54</span>))</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(r7<span class="sc">$</span>parsed, <span class="at">con =</span> <span class="st">"img/chart3.svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For square charts, use query arguments <code>list(height = 18/2.54, width = 18/2.54)</code> to generate the plot. In order to get the same age units as the previous chart, calculate <code>out.width</code> as <code>500/21*18 = "429px"</code>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/chart3.svg" class="img-fluid figure-img" width="429"></p>
<figcaption>Predict Laura’s future height at the age of 3y9m.</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Upload <code>maria.json</code> and draw the height data on the default chart to produce an SVG file. Specify the proper <code>width</code> and <code>height</code> query parameters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-sX</span> <span class="st">'POST'</span> <span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span><span class="st">'/charts/draw/svglite?width=7.09&amp;height=7.09'</span> <span class="dt">\</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>-H <span class="st">'accept: image/*'</span> <span class="dt">\</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>-F <span class="st">'txt=@maria.json;type=application/json'</span> <span class="op">&gt;</span> maria1.svg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We need to set <code>chartcode</code> and <code>selector</code> parameters to choose a different chart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-sX</span> <span class="st">'POST'</span> <span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span><span class="st">'/charts/draw/svglite?width=8.27&amp;height=11.69'</span> <span class="dt">\</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>-H <span class="st">'accept: image/*'</span> <span class="dt">\</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>-F <span class="st">"chartcode='PMAAN27'"</span> <span class="dt">\</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>-F <span class="st">"selector='chartcode'"</span> <span class="dt">\</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>-F <span class="st">'txt=@maria.json;type=application/json'</span> <span class="op">&gt;</span> maria2.svg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>An alternative is to read the data from a URL, and use the <code>application/json</code> protocol to specify parameters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-sX</span> <span class="st">'POST'</span> <span class="dt">\</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span><span class="st">'/charts/draw/svglite?width=8.27&amp;height=11.69'</span> <span class="dt">\</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>-H <span class="st">'accept: image/*'</span> <span class="dt">\</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>-H <span class="st">'Content-Type: application/json'</span> <span class="dt">\</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>-d <span class="st">'{</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="st">"txt": "'</span><span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span><span class="st">'/ocpu/library/jamesdemodata/extdata/bds_v3.0/smocc/Laura_S.json",</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="st">"chartcode" : "NMBA", </span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="st">"selector" : "chartcode"}'</span> <span class="op">&gt;</span> laura.svg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="chartslist-list-available-growth-charts" class="level3">
<h3 class="anchored" data-anchor-id="chartslist-list-available-growth-charts"><strong><code>/charts/list</code></strong>: List available growth charts</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">bash</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>JAMES contains a wide variety of built-in growth charts. Each chart has a unique <code>chartcode</code>. A typical chart code looks like <code>NJAA</code>. We obtain the full list of chart codes as</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host, <span class="at">path =</span> <span class="st">"charts/list/json"</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>charts <span class="ot">&lt;-</span> r<span class="sc">$</span>parsed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>charts</code> object is a data frame with <code>??</code> rows (charts) and the following variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(charts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "chartgrp"   "chartcode"  "population" "sex"        "design"    
[6] "side"       "language"   "week"      </code></pre>
</div>
</div>
<p>JAMES contains charts for various child populations. There are charts for Down syndrome (DS), Hindustan (HS), Moroccan (MA), Dutch (NL)), preterm (PT) and Turkish (TU) children living in the Netherlands and the WHO Growth Standards (WHOblue, WHOpink). These charts contain references for height (hgt), weight (wgt), head circumference (hdc), weight-for-height (wfh), body mass index (bmi) and D-score (dsc), as well as combined charts with multiple references on A4 format (front, back, -hdc).</p>
<p>The most important index variables are <code>population</code> and <code>side</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(charts, <span class="fu">table</span>(population, side))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          side
population -hdc back bmi dsc front hdc hgt wfh wgt
   DS         0    6   2   0     6   6   6   4   2
   HS         4    2   2   0     6   2   6   4   2
   MA         0    6   2   0     6   6   6   4   2
   NL         2    8   2   4     8   8   8   4   4
   PT         0   24   0  48    48  24  48   0  48
   TU         0    6   2   0     6   6   6   4   2
   WHOblue    0    0   0  26     2   1   2   1   1
   WHOpink    0    0   0  26     2   1   2   1   1</code></pre>
</div>
</div>
<p>The URL <code>{host}/site</code> (see below) displays the currently active chart code as a field in the left sidebar.</p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Restrict the listing to the WHO references:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-sX</span> <span class="st">'POST'</span> <span class="dt">\</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span><span class="st">'/charts/list/json'</span> <span class="dt">\</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>-H <span class="st">'accept: application/json'</span> <span class="dt">\</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>-H <span class="st">'Content-Type: application/json'</span> <span class="dt">\</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>-d <span class="st">'{</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="st">"chartgrp": "who"</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="st">}'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="chartsvalidate-validate-chart-codes" class="level3">
<h3 class="anchored" data-anchor-id="chartsvalidate-validate-chart-codes"><strong><code>/charts/validate</code></strong>: Validate chart codes</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">bash</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>The <code>/charts/validate</code> end point attempt to find one or more user-specified chart codes. For example, the following cocde checkc five chart codes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host, </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">path =</span> <span class="st">"charts/validate/json"</span>, </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">chartcode =</span> <span class="fu">c</span>(<span class="st">"NMAW"</span>, <span class="st">"NJAb"</span>, <span class="st">"PJAAN23"</span>, <span class="st">"PJAAN25"</span>, <span class="st">"dummy"</span>))</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>r<span class="sc">$</span>parsed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE FALSE  TRUE FALSE</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Check five chart codes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-sX</span> <span class="st">'POST'</span> <span class="dt">\</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span><span class="st">'/charts/validate/json'</span> <span class="dt">\</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>-H <span class="st">'accept: application/json'</span> <span class="dt">\</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>-H <span class="st">'Content-Type: application/json'</span> <span class="dt">\</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>-d <span class="st">'{</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="st">"chartcode": [</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="st">"NMAW",</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="st">"NJAB",</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="st">"PJAAN23",</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="st">"PJAAN25", </span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="st">"dummy"</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="st">]</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="st">}'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[true, true, false, true, false]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="screenerslist-list-available-growth-screeners" class="level3">
<h3 class="anchored" data-anchor-id="screenerslist-list-available-growth-screeners"><strong><code>/screeners/list</code></strong>: List available growth screeners</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">bash</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>JAMES implements several screening algorithms. The <code>/screeners/list</code> end point provides detailed information on each of these.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host, <span class="at">path =</span> <span class="st">"/screeners/list/json"</span>, </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">session =</span> r1<span class="sc">$</span>session)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(r<span class="sc">$</span>parsed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Versie"                "yname"                 "Categorie"            
[4] "CategorieOmschrijving" "JGZRichtlijn"          "Code"                 
[7] "CodeOmschrijving"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(r<span class="sc">$</span>parsed, <span class="fu">table</span>(yname, Categorie))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Categorie
yname 1000 2000 3000
  hdc    0    0   17
  hgt   45    0    0
  wgt    0   26    0</code></pre>
</div>
</div>
<p>There are currently 88 different codes. Codes ending in <code>31</code>, e.g., <code>1031</code> or <code>2031</code> indicate normal growth, whereas code ending in <code>41</code>, <code>42</code> and so on, signal that - according to the guidelines - the child should be referred for further investigation.</p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>We get the details for the guidelines for head circumference as</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-sX</span> <span class="st">'POST'</span> <span class="dt">\</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span><span class="st">'/screeners/list/json'</span> <span class="dt">\</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>-H <span class="st">'accept: application/json'</span> <span class="dt">\</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>-H <span class="st">'Content-Type: application/json'</span> <span class="dt">\</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>-d <span class="st">'{"ynames": "hdc"}'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="screenersapply-apply-growth-screeners-to-child-data" class="level3">
<h3 class="anchored" data-anchor-id="screenersapply-apply-growth-screeners-to-child-data"><strong><code>/screeners/apply</code></strong>: Apply growth screeners to child data</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">bash</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>The <code>/screeners/apply</code> end point applies standard screeners to the child data. Invoke the screeners by</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host, <span class="at">path =</span> <span class="st">"/screeners/apply/json"</span>, </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">session =</span> r1<span class="sc">$</span>session)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>r<span class="sc">$</span>parsed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Categorie CategorieOmschrijving Code
1      1000                Lengte 1031
2      2000               Gewicht 2031
3      3000           Hoofdomtrek 3031
                                                                                                               CodeOmschrijving
1 Het advies volgens de JGZ-richtlijn lengtegroei is als volgt: In principe geen verwijzing nodig, naar eigen inzicht handelen.
2 Het advies volgens de JGZ-richtlijn overgewicht is als volgt: In principe geen verwijzing nodig, naar eigen inzicht handelen.
3                                                               In principe geen verwijzing nodig, naar eigen inzicht handelen.
  Versie Leeftijd
1 1.23.0    0.167
2 1.23.0    0.167
3 1.23.0    0.167</code></pre>
</div>
</div>
<p>The procedure</p>
<ol type="1">
<li>calculates, per outcome, the intervals between the most recent measurement and all earlier measurements;</li>
<li>tests whether any of those intervals produces a signal according the screening algorithm;</li>
<li>reports the most recent non-standard signal that indicate abnormal growth.</li>
</ol>
<p>In the example, all returned codes (1031, 2031, 3031) end in “31”, which signals normal growth. The full table of return codes and messages can be obtained by the <code>/screeners/list</code> end point (see above).</p>
<p>There are several possibilities to visualise and integrate multiple evaluations per curve performed in step 2 into one advice. Before May 2023, JAMES returned an advice for each combination of time point and outcome, but that table presented a lot of output that was difficult to act one. Since May 2023, JAMES reports only one signal per curve.</p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-sX</span> <span class="st">'POST'</span> <span class="dt">\</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span><span class="st">'/screeners/apply/json'</span> <span class="dt">\</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>-H <span class="st">'accept: application/json'</span> <span class="dt">\</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>-H <span class="st">'Content-Type: multipart/form-data'</span> <span class="dt">\</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>-F <span class="st">'txt=@maria.json;type=application/json'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[
  {
    "Categorie": 1000,
    "CategorieOmschrijving": "Lengte",
    "Code": 1031,
    "CodeOmschrijving": "Het advies volgens de JGZ-richtlijn lengtegroei is als volgt: In principe geen verwijzing nodig, naar eigen inzicht handelen.",
    "Versie": "1.23.0",
    "Leeftijd": 0.167
  },
  {
    "Categorie": 2000,
    "CategorieOmschrijving": "Gewicht",
    "Code": 2031,
    "CodeOmschrijving": "Het advies volgens de JGZ-richtlijn overgewicht is als volgt: In principe geen verwijzing nodig, naar eigen inzicht handelen.",
    "Versie": "1.23.0",
    "Leeftijd": 0.167
  },
  {
    "Categorie": 3000,
    "CategorieOmschrijving": "Hoofdomtrek",
    "Code": 3031,
    "CodeOmschrijving": "In principe geen verwijzing nodig, naar eigen inzicht handelen.",
    "Versie": "1.23.0",
    "Leeftijd": 0.167
  }
]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="site-request-an-empty-site" class="level3">
<h3 class="anchored" data-anchor-id="site-request-an-empty-site"><strong><code>/site</code></strong>: Request an empty site</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">bash</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>The <code>/site</code> end point provides interactive site containing all charts, but without child data. This end point is primarily useful to obtain a quick overview of the available charts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">browseURL</span>(<span class="fu">file.path</span>(host, <span class="st">"site"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">

</div>
</div>
</div>
</section>
<section id="siterequest-request-personalised-site" class="level3">
<h3 class="anchored" data-anchor-id="siterequest-request-personalised-site"><strong><code>/site/request</code></strong>: Request personalised site</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">bash</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>The <code>/site/request</code> end point creates an URL to a personalised, interactive site containing all charts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host, <span class="at">path =</span> <span class="st">"/site/request/json"</span>, </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">sitehost =</span> host, <span class="at">txt =</span> js)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Run the command and then <code>browseURL(r$parsed)</code> to see the site. The starting chart is chosen by JAMES and depends on the age of the child.</p>
<p>Alteratively, we may start from the <code>session</code> created by <code>/data/upload</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host, <span class="at">path =</span> <span class="st">"/site/request/json"</span>, </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">sitehost =</span> host, <span class="at">session =</span> r1<span class="sc">$</span>session)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Run the command and paste the generated URL in <code>r$parsed</code> in the address field of your browser. The starting chart is chosen by JAMES and depends on the age of the child.</p>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-sX</span> <span class="st">'POST'</span> <span class="dt">\</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span><span class="st">'/site/request/json'</span> <span class="dt">\</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>-H <span class="st">'accept: application/json'</span> <span class="dt">\</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>-H <span class="st">'Content-Type: multipart/form-data'</span> <span class="dt">\</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>-F <span class="st">"sitehost='</span><span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span><span class="st">'"</span> <span class="dt">\</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>-F <span class="st">'txt=@maria.json;type=application/json'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="blendrequest-obtain-a-blend-from-multiple-end-points" class="level3">
<h3 class="anchored" data-anchor-id="blendrequest-obtain-a-blend-from-multiple-end-points"><strong><code>/blend/request</code></strong>: Obtain a blend from multiple end points</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">bash</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<p>The <code>/blend/request</code> end point returns the results of multiple end points, and thus functions as a one-stop shop. However, currently it does not support graphics output, so use <code>/{session}/{info}/svglite</code> or <code>/charts/draw/svglite</code> for the charts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"bds_v3.0"</span>, <span class="st">"smocc"</span>, <span class="st">"Laura_S.json"</span>,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">package =</span> <span class="st">"jamesdemodata"</span>, <span class="at">mustWork =</span> <span class="cn">TRUE</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">james_post</span>(<span class="at">host =</span> host, <span class="at">path =</span> <span class="st">"/blend/request/json"</span>, </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">sitehost =</span> host, <span class="at">txt =</span> fn)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>r<span class="sc">$</span>parsed<span class="sc">$</span>screeners</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Categorie CategorieOmschrijving Code
1      1000                Lengte 1031
2      2000               Gewicht 2075
3      3000           Hoofdomtrek 3021
                                                                                                                                                                                                                                                                                                                                                        CodeOmschrijving
1                                                                                                                                                                                                                                          Het advies volgens de JGZ-richtlijn lengtegroei is als volgt: In principe geen verwijzing nodig, naar eigen inzicht handelen.
2 Het advies volgens de JGZ-richtlijn ondergewicht is als volgt: Sterke gewichtsafname (-1 SD), advies: Is er sprake van een afwijkende voedingstoestand en/of klachten of symptomen die kunnen wijzen op onderliggende ziekte of problemen? Indien ja, Verwijzen naar kinderarts. Indien nee, dan is er in principe geen verwijzing nodig. Naar eigen inzicht handelen.
3                                                                                                                                                                                                                                                                                                          De richtlijn hoofdomtrek is bedoeld voor kinderen tot 1 jaar.
  Versie Leeftijd
1 1.23.0     2.04
2 1.23.0     2.04
3 1.23.0     2.04</code></pre>
</div>
</div>
<p>Inspect <code>r$parsed</code> to see which other components are returned.</p>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-sX</span> <span class="st">'POST'</span> <span class="dt">\</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span><span class="st">'/blend/request/json'</span> <span class="dt">\</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>-H <span class="st">'accept: application/json'</span> <span class="dt">\</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>-H <span class="st">'Content-Type: application/json'</span> <span class="dt">\</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>-d <span class="st">'{</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="st">"txt": "'</span><span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span><span class="st">'/ocpu/library/jamesdemodata/json/examples/Laura_S.json",</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="st">"sitehost": "'</span><span class="va">$(</span><span class="fu">cat</span> .host<span class="va">)</span><span class="st">'",</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="st">"blend": "standard"</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="st">}'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="resources" class="level2">
<h2 class="anchored" data-anchor-id="resources">Resources</h2>
<section id="internal" class="level3">
<h3 class="anchored" data-anchor-id="internal">Internal</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="https://growthcharts.org/james/news/index.html">Changelog</a></td>
<td style="text-align: left;">open</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://app.swaggerhub.com/apis/stefvanbuuren/james/1.5.4">OpenAPI specification</a></td>
<td style="text-align: left;">open</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://github.com/growthcharts">Source files</a></td>
<td style="text-align: left;">open</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://github.com/growthcharts/bdsreader/blob/master/inst/schemas/bds_v3.0.json">JSON data schema 3.0</a></td>
<td style="text-align: left;">open</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://github.com/growthcharts/james/issues">JAMES issue tracker</a></td>
<td style="text-align: left;">open</td>
</tr>
</tbody>
</table>
</section>
<section id="external" class="level3">
<h3 class="anchored" data-anchor-id="external">External</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="https://tnochildhealthstatistics.shinyapps.io/james_tryout/">JAMES demo</a></td>
<td style="text-align: left;">current</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://www.ncj.nl/themadossiers/informatisering/basisdataset/documentatie/?cat=13">Basisdataset JGZ</a></td>
<td style="text-align: left;">current</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://www.opencpu.org/api.html">OpenCPU API</a></td>
<td style="text-align: left;">current</td>
</tr>
</tbody>
</table>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>